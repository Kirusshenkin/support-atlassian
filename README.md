# AI Confluence Assistant

Slack-ะฑะพั ะดะปั ะพัะฒะตัะพะฒ ะฝะฐ ะฒะพะฟัะพัั ะฟะพ ะดะพะบัะผะตะฝัะฐัะธะธ Confluence ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะตะผะฐะฝัะธัะตัะบะพะณะพ ะฟะพะธัะบะฐ ะธ LLM.

## ๐ ะัััััะน ััะฐัั (5 ะบะพะผะฐะฝะด)

```bash
# 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั
git clone https://github.com/your-org/ai-confluence-assistant.git
cd ai-confluence-assistant

# 2. ะะพะฟะธัะพะฒะฐะฝะธะต ะธ ะฝะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
cp env.example .env
# ะััะตะดะฐะบัะธััะนัะต .env ะธ ะทะฐะฟะพะปะฝะธัะต ะฒัะต ะฝะตะพะฑัะพะดะธะผัะต ะทะฝะฐัะตะฝะธั

# 3. ะะตัะฒะธัะฝะฐั ะธะฝะดะตะบัะฐัะธั ะดะพะบัะผะตะฝัะฐัะธะธ
docker compose run --rm ingest

# 4. ะะฐะฟััะบ QA-ัะตัะฒะธัะฐ ะธ Slack-ะฑะพัะฐ
docker compose up -d api bot

# 5. ะัะพะฒะตัะบะฐ ััะฐัััะฐ
docker compose ps
curl http://localhost:8000/health
```

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- Docker ะธ Docker Compose
- Confluence API ัะพะบะตะฝ
- Slack Bot ะธ App ัะพะบะตะฝั
- LLM ะฝะฐ ะฒัะฑะพั:
  - **Anthropic Claude API** (โญ ัะตะบะพะผะตะฝะดัะตััั ะดะปั ะปัััะตะณะพ ะบะฐัะตััะฒะฐ)
  - OpenAI API ะบะปัั (ะฟัะพะฒะตัะตะฝะฝัะน ััะฐะฝะดะฐัั)
  - Google Gemini (ะปัััะฐั ัะตะฝะฐ/ะบะฐัะตััะฒะพ)
  - ะะพะบะฐะปัะฝะฐั ะผะพะดะตะปั (Llama, Qwen) - ะดะปั ะบะพะฝัะธะดะตะฝัะธะฐะปัะฝะพััะธ
  - [ะััะณะธะต ะพะฑะปะฐัะฝัะต ะฟัะพะฒะฐะนะดะตัั](docs/CLOUD_LLM_OPTIONS.md)
- Python 3.11 (ะดะปั ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ)

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฝะฐ ะพัะฝะพะฒะต `.env.example`:

```env
# Confluence
CF_URL=https://your-company.atlassian.net/wiki
CF_USER=bot@company.com
CF_TOKEN=your-confluence-api-token
CF_SPACE=DOCS
CF_PAGES=  # ะัััะพ = ะฒัะต ัััะฐะฝะธัั ะฒ ะฟัะพัััะฐะฝััะฒะต

# Slack
SLACK_BOT_TOKEN=xoxb-...
SLACK_APP_TOKEN=xapp-...

# LLM (ัะตะบะพะผะตะฝะดัะตััั Anthropic Claude)
LLM_PROVIDER=anthropic
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# ะะปะธ ะธัะฟะพะปัะทัะนัะต OpenAI
# LLM_PROVIDER=openai
# OPENAI_API_KEY=sk-...
# OPENAI_MODEL=gpt-4o-mini

# ะะฐัััะพะนะบะธ ะฟะพะธัะบะฐ
RETRIEVER_K=4
CHUNK_SIZE=800
CHUNK_OVERLAP=120
```

๐ **ะะพะดัะพะฑะฝะตะต ะพ ะฒัะฑะพัะต LLM:** 
- [ะะฑะปะฐัะฝัะต LLM ะฟัะพะฒะฐะนะดะตัั](docs/CLOUD_LLM_OPTIONS.md) - ััะฐะฒะฝะตะฝะธะต ะบะฐัะตััะฒะฐ ะธ ัะตะฝ
- [ะะพะบะฐะปัะฝัะต LLM](docs/LOCAL_LLM_OPTIONS.md) - ะดะปั ะบะพะฝัะธะดะตะฝัะธะฐะปัะฝะพััะธ ะธ ัะบะพะฝะพะผะธะธ

### ะะฐัััะพะนะบะฐ Slack App

1. ะกะพะทะดะฐะนัะต ะฝะพะฒะพะต Slack App ะฝะฐ https://api.slack.com/apps
2. ะะบะปััะธัะต Socket Mode ะธ ะฟะพะปััะธัะต App Token
3. ะะพะฑะฐะฒััะต Bot User ะธ ะฟะพะปััะธัะต Bot Token
4. ะะพะฑะฐะฒััะต ัะปะตะดัััะธะต Bot Token Scopes:
   - `app_mentions:read`
   - `channels:history`
   - `chat:write`
   - `im:history`
   - `groups:history`
5. ะะบะปััะธัะต Event Subscriptions ะดะปั:
   - `app_mention`
   - `message.channels`
   - `message.groups`
   - `message.im`

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ
โ   Slack     โโโโโโถโ  Slack Bot  โโโโโโถโ QA Service  โ
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ
                                               โ
                                               โผ
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ
โ Confluence  โโโโโโถโ   Ingest    โโโโโโถโ  ChromaDB   โ
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโ
```

## ๐ฆ ะะพะผะฟะพะฝะตะฝัั

### 1. Ingest Service (`src/ingest_with_report.py`)
- ะัะณััะถะฐะตั ัััะฐะฝะธัั ะธะท Confluence
- ะะพะฝะฒะตััะธััะตั HTML ะฒ ัะตะบัั
- ะกะพะทะดะฐะตั ัะผะฑะตะดะดะธะฝะณะธ ะธ ัะพััะฐะฝัะตั ะฒ ChromaDB
- ะะตะฝะตัะธััะตั CSV-ะพััะตัั

### 2. QA Service (`src/qa_service.py`)
- FastAPI ะฟัะธะปะพะถะตะฝะธะต ั endpoint `/ask`
- ะกะตะผะฐะฝัะธัะตัะบะธะน ะฟะพะธัะบ ะฟะพ ChromaDB
- ะะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ ัะตัะตะท LLM

### 3. Slack Bot (`src/slack_bot.py`)
- ะะฑัะฐะฑะฐััะฒะฐะตั ะบะพะผะฐะฝะดั `ask ...`
- ะัะฟัะฐะฒะปัะตั ะทะฐะฟัะพัั ะบ QA Service
- ะคะพัะผะฐัะธััะตั ะพัะฒะตัั ะดะปั Slack

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต ะดะฐะฝะฝัั

### ะััะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต
```bash
docker compose run --rm ingest
```

### ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต (cron)
```bash
docker compose --profile scheduler up -d scheduler
```

### GitHub Actions
ะะฐัััะพะตะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ ะบะฐะถะดัั ะฝะพัั ะฒ 01:30 UTC.

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะธัะพะฒ
```bash
curl http://localhost:8000/health
```

### ะัะพัะผะพัั ะปะพะณะพะฒ
```bash
docker compose logs -f api
docker compose logs -f bot
```

### ะัะพัะผะพัั ะพััะตัะพะฒ
```bash
cat report/ingested.csv
cat report/skipped.csv
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะพะบะฐะปัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต API
```bash
curl -X POST http://localhost:8000/ask \
  -H "Content-Type: application/json" \
  -d '{"text": "Where is health endpoint?"}'
```

### ะขะตััะธัะพะฒะฐะฝะธะต ะฒ Slack
ะะฐะฟะธัะธัะต ะฒ ะปัะฑะพะผ ะบะฐะฝะฐะปะต, ะณะดะต ะตััั ะฑะพั:
```
ask ะบะฐะบ ะฝะฐัััะพะธัั API?
```

## ๐จ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะพั ะฝะต ะพัะฒะตัะฐะตั
1. ะัะพะฒะตัััะต ะปะพะณะธ: `docker compose logs bot`
2. ะัะพะฒะตัััะต ะทะดะพัะพะฒัะต API: `curl http://localhost:8000/health`
3. ะฃะฑะตะดะธัะตัั, ััะพ ะฑะพั ะดะพะฑะฐะฒะปะตะฝ ะฒ ะบะฐะฝะฐะป

### ะัะธะฑะบะธ ะธะฝะดะตะบัะฐัะธะธ
1. ะัะพะฒะตัััะต ะดะพัััะฟ ะบ Confluence API
2. ะัะพะฒะตัััะต ะปะธะผะธัั API (50 req/min)
3. ะะพัะผะพััะธัะต `report/skipped.csv` ะดะปั ะดะตัะฐะปะตะน

### ะััััะต ะพัะฒะตัั
1. ะฃะฑะตะดะธัะตัั, ััะพ ะธะฝะดะตะบัะฐัะธั ะฟัะพัะปะฐ ััะฟะตัะฝะพ
2. ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ะดะพะบัะผะตะฝัะพะฒ ะฒ ChromaDB
3. ะฃะฒะตะปะธัััะต `RETRIEVER_K` ะดะปั ะฑะพะปััะตะณะพ ะบะพะฝัะตะบััะฐ

## ๐ ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

### ะฃะฒะตะปะธัะตะฝะธะต ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- ะัะฟะพะปัะทัะนัะต GPU ะดะปั ัะผะฑะตะดะดะธะฝะณะพะฒ
- ะะตัะตะบะปััะธัะตัั ะฝะฐ Postgres-backed ChromaDB
- ะะฐะฟัััะธัะต ะฝะตัะบะพะปัะบะพ ัะบะทะตะผะฟะปััะพะฒ QA Service

### ะะพะปััะธะต ะพะฑัะตะผั ะดะพะบัะผะตะฝัะฐัะธะธ
- ะะฐัััะพะนัะต ะฑะฐััะตะฒัั ะพะฑัะฐะฑะพัะบั ะฒ ingest
- ะัะฟะพะปัะทัะนัะต ะฑะพะปะตะต ะผะพัะฝัั ะผะพะดะตะปั ัะผะฑะตะดะดะธะฝะณะพะฒ
- ะะฐััะผะพััะธัะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ClickHouse

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. Fork ัะตะฟะพะทะธัะพัะธั
2. ะกะพะทะดะฐะนัะต feature branch
3. Commit ะธะทะผะตะฝะตะฝะธะน
4. Push ะฒ branch
5. ะกะพะทะดะฐะนัะต Pull Request

## ๐ ะะปะฐะฝั ัะฐะทะฒะธัะธั

ะกะผ. [ROADMAP.md](ROADMAP.md) ะดะปั ะดะตัะฐะปัะฝะพะณะพ ะฟะปะฐะฝะฐ ัะฐะทะฒะธัะธั ะฟัะพะตะบัะฐ.

ะัะฝะพะฒะฝัะต ะฝะฐะฟัะฐะฒะปะตะฝะธั v2.0:
- ๐ ะะฝะฐะปะธะท ัะตะปะธะทะพะฒ ะธะท Slack ะบะฐะฝะฐะปะพะฒ
- ๐ ะะฝัะตะณัะฐัะธั ั GitHub ะดะปั ะฐะฝะฐะปะธะทะฐ Pull Requests
- ๐ ะกะพะฟะพััะฐะฒะปะตะฝะธะต ัะตะปะธะทะพะฒ ะผะตะถะดั ัะฐะทะปะธัะฝัะผะธ ะธััะพัะฝะธะบะฐะผะธ

## ๐ ะะธัะตะฝะทะธั

MIT License - ัะผ. ัะฐะนะป LICENSE

## ๐ ะะพะดะดะตัะถะบะฐ

- Issues: https://github.com/your-org/ai-confluence-assistant/issues
- Wiki: https://github.com/your-org/ai-confluence-assistant/wiki
- Email: support@company.com # support-atlassian
