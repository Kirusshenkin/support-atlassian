# –û–±–ª–∞—á–Ω—ã–µ LLM –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–ª—è AI Confluence Assistant

## üèÜ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª—å | –ö–∞—á–µ—Å—Ç–≤–æ | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ | –°–∫–æ—Ä–æ—Å—Ç—å | –¶–µ–Ω–∞ |
|-----------|--------|----------|--------------|----------|------|
| **Anthropic** | Claude 3 Opus | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | $$$$ |
| **Anthropic** | Claude 3 Sonnet | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | $$$ |
| **OpenAI** | GPT-4o | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | $$$ |
| **Google** | Gemini 1.5 Pro | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | $$ |
| **OpenAI** | GPT-4o-mini | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | $ |
| **Cohere** | Command R+ | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | $$ |
| **YandexGPT** | Pro | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | $$ |
| **YandexGPT** | Lite | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | $ |

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

### 1. **Anthropic Claude** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –õ—É—á—à–∏–π –≤—ã–±–æ—Ä
```python
# –í requirements.txt
anthropic>=0.25.0

# –í .env
ANTHROPIC_API_KEY=sk-ant-...
LLM_PROVIDER=anthropic
ANTHROPIC_MODEL=claude-3-sonnet-20240229  # –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
# –∏–ª–∏ claude-3-opus-20240229 –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –õ—É—á—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- –û–≥—Ä–æ–º–Ω–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –æ–∫–Ω–æ (200K —Ç–æ–∫–µ–Ω–æ–≤)
- –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏
- –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º
- –ú–µ–Ω—å—à–µ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞ –æ—Ç–≤–µ—Ç–æ–≤

### 2. **OpenAI GPT-4** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç
```python
# –í requirements.txt
openai>=1.0.0

# –í .env
OPENAI_API_KEY=sk-...
LLM_PROVIDER=openai
OPENAI_MODEL=gpt-4o  # –∏–ª–∏ gpt-4o-mini –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç
- –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –ë–æ–ª—å—à–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞
- –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è
- –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ OpenAI —Å–∏—Å—Ç–µ–º–∞–º–∏

### 3. **Google Vertex AI (Gemini)** ‚≠ê‚≠ê‚≠ê‚≠ê –õ—É—á—à–∞—è —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ
```python
# –í requirements.txt
google-cloud-aiplatform>=1.38.0
langchain-google-vertexai>=0.1.0

# –í .env
GOOGLE_APPLICATION_CREDENTIALS=path/to/credentials.json
LLM_PROVIDER=vertexai
VERTEX_AI_PROJECT=your-project-id
VERTEX_AI_LOCATION=us-central1
VERTEX_AI_MODEL=gemini-1.5-pro
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Cloud
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ multimodal (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- –•–æ—Ä–æ—à–∞—è —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ

### 4. **Amazon Bedrock** ‚≠ê‚≠ê‚≠ê‚≠ê –ì–∏–±–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π
```python
# –í requirements.txt
boto3>=1.28.0
langchain-aws>=0.1.0

# –í .env
AWS_ACCESS_KEY_ID=your-key
AWS_SECRET_ACCESS_KEY=your-secret
AWS_DEFAULT_REGION=us-east-1
LLM_PROVIDER=bedrock
BEDROCK_MODEL_ID=anthropic.claude-3-sonnet-20240229-v1:0
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π (Claude, Llama, Mistral)
- Pay-per-use
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AWS

### 5. **Azure OpenAI Service** ‚≠ê‚≠ê‚≠ê‚≠ê –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–π
```python
# –í requirements.txt
langchain-openai>=0.1.0

# –í .env
AZURE_OPENAI_API_KEY=your-key
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-01
LLM_PROVIDER=azure_openai
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- SLA –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Azure —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π
- –î–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ

### 6. **Cohere** ‚≠ê‚≠ê‚≠ê –•–æ—Ä–æ—à–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
```python
# –í requirements.txt
cohere>=4.0.0
langchain-cohere>=0.1.0

# –í .env
COHERE_API_KEY=your-key
LLM_PROVIDER=cohere
COHERE_MODEL=command-r-plus
```

### 7. **Yandex YandexGPT** ‚≠ê‚≠ê –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ –†–§
```python
# –í requirements.txt
yandexcloud>=0.250.0

# –í .env
YANDEX_CLOUD_API_KEY=your-key
YANDEX_FOLDER_ID=your-folder-id
LLM_PROVIDER=yandexgpt
YANDEX_MODEL=yandexgpt-lite
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –†–æ—Å—Å–∏–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 152-–§–ó
- –ù–µ–ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç—É–ø–∞–µ—Ç –ø–æ –∫–∞—á–µ—Å—Ç–≤—É Claude –∏ GPT-4
- –ú–µ–Ω—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- –°–∫–ª–æ–Ω–µ–Ω –∫ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è–º

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –†–§
- –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

## üîß –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 1. –û–±–Ω–æ–≤–∏—Ç–µ `src/qa_service.py`:

```python
from typing import Optional
import os

def create_llm():
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è LLM –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞"""
    provider = os.getenv("LLM_PROVIDER", "openai")
    
    if provider == "openai":
        from langchain_openai import ChatOpenAI
        return ChatOpenAI(
            api_key=os.getenv("OPENAI_API_KEY"),
            model=os.getenv("OPENAI_MODEL", "gpt-4o-mini"),
            temperature=0.3
        )
    
    elif provider == "anthropic":
        from langchain_anthropic import ChatAnthropic
        return ChatAnthropic(
            api_key=os.getenv("ANTHROPIC_API_KEY"),
            model=os.getenv("ANTHROPIC_MODEL", "claude-3-sonnet-20240229"),
            temperature=0.3
        )
    
    elif provider == "azure_openai":
        from langchain_openai import AzureChatOpenAI
        return AzureChatOpenAI(
            azure_endpoint=os.getenv("AZURE_OPENAI_ENDPOINT"),
            api_key=os.getenv("AZURE_OPENAI_API_KEY"),
            deployment_name=os.getenv("AZURE_OPENAI_DEPLOYMENT_NAME"),
            api_version=os.getenv("AZURE_OPENAI_API_VERSION"),
            temperature=0.3
        )
    
    elif provider == "vertexai":
        from langchain_google_vertexai import ChatVertexAI
        return ChatVertexAI(
            project=os.getenv("VERTEX_AI_PROJECT"),
            location=os.getenv("VERTEX_AI_LOCATION"),
            model=os.getenv("VERTEX_AI_MODEL", "gemini-1.5-pro"),
            temperature=0.3
        )
    
    elif provider == "bedrock":
        from langchain_aws import ChatBedrock
        return ChatBedrock(
            model_id=os.getenv("BEDROCK_MODEL_ID"),
            region_name=os.getenv("AWS_DEFAULT_REGION"),
            model_kwargs={"temperature": 0.3}
        )
    
    elif provider == "yandexgpt":
        from langchain_community.llms import YandexGPT
        return YandexGPT(
            api_key=os.getenv("YANDEX_CLOUD_API_KEY"),
            folder_id=os.getenv("YANDEX_FOLDER_ID"),
            model_name=os.getenv("YANDEX_MODEL", "yandexgpt-lite")
        )
    
    else:
        raise ValueError(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä: {provider}")
```

### 2. –û–±–Ω–æ–≤–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ `QAService`:

```python
def initialize(self):
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–µ—Ä–≤–∏—Å–∞"""
    try:
        # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LLM —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏–∫—É
        self.llm = create_llm()
        logger.info(f"LLM –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: {os.getenv('LLM_PROVIDER', 'openai')}")
        
        # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
```

## üí∞ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (–Ω–∞ 1–ú —Ç–æ–∫–µ–Ω–æ–≤)

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª—å | Input | Output |
|-----------|--------|-------|--------|
| OpenAI | GPT-4o-mini | $0.15 | $0.60 |
| Anthropic | Claude 3 Sonnet | $3.00 | $15.00 |
| Google | Gemini 1.5 Pro | $3.50 | $10.50 |
| Azure OpenAI | GPT-4 | $30.00 | $60.00 |
| YandexGPT | Lite | ‚ÇΩ0.20 | ‚ÇΩ0.40 |
| Cohere | Command R+ | $3.00 | $15.00 |

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

### –î–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π:
1. **YandexGPT** - –¥–∞–Ω–Ω—ã–µ –≤ –†–§, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 152-–§–ó
2. **Azure OpenAI** - –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ä–µ–≥–∏–æ–Ω (–≤–∫–ª—é—á–∞—è –ï–≤—Ä–æ–ø—É)
3. **–ü—Ä–∏–≤–∞—Ç–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** - —Å–º. –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏

### –î–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π:
1. **Azure OpenAI** - –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ SLA
2. **AWS Bedrock** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
3. **Google Vertex AI** - GDPR compliant

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞**: Anthropic Claude 3 Sonnet/Opus
2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä**: OpenAI GPT-4o
3. **–î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Å —Ö–æ—Ä–æ—à–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º**: Google Gemini 1.5 Pro –∏–ª–∏ GPT-4o-mini
4. **–î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–π**: Azure OpenAI
5. **–î–ª—è –†–æ—Å—Å–∏–∏ (–µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ)**: –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ YandexGPT

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Anthropic Claude –∏–ª–∏ OpenAI GPT-4. –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –º–æ–¥–µ–ª–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ç–æ—á–Ω—ã–º –∏–ª–∏ –≤–≤–æ–¥—è—â–∏–º –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞–º. 